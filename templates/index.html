<!DOCTYPE html>
<html lang="vi">
<head>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <title>üì∞ E-CON_NEWS.EXE - TERMINAL INTERFACE v2.024</title>
    
    <!-- SEO & Meta Tags -->
    <meta name="description" content="E-con News Terminal - AI-powered financial news portal with retro brutalism design. Real-time market analysis with terminal interface.">
    <meta name="keywords" content="terminal news, retro brutalism, AI news, financial tech, neo-brutalism, economic analysis">
    <meta name="author" content="E-con News Protocol">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#00ff00">
    <meta name="msapplication-navbutton-color" content="#00ff00">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="E-con News Terminal - AI Financial Analysis">
    <meta property="og:description" content="Retro brutalism news portal with AI-powered financial analysis and terminal interface">
    <meta property="og:image" content="/static/og-image.png">
    <meta property="og:url" content="{{ request.url }}">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="E-con News Terminal">
    <meta name="twitter:description" content="AI-powered financial news with retro brutalism design">
    
    <!-- PWA Support -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="E-con News Terminal">
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    
    <!-- Fonts - Performance Optimized -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üñ•Ô∏è</text></svg>">
    <link rel="apple-touch-icon" sizes="180x180" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23000000'/><text x='50' y='65' font-size='60' text-anchor='middle' fill='%2300ff00'>üñ•Ô∏è</text></svg>">
    
    <!-- Stylesheets with cache busting -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v={{ range(1000, 9999) | random }}">
    
    <!-- Preload Critical Resources -->
    <link rel="prefetch" href="{{ url_for('static', filename='script.js') }}" as="script">
    
    <!-- Performance Hints -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "E-con News Terminal",
        "description": "AI-powered financial news portal with retro brutalism design",
        "url": "{{ request.url_root }}",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "{{ request.url_root }}?search={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    
    <!-- Critical CSS for immediate rendering -->
    <style>
        /* Critical CSS to prevent FOUC */
        body {
            margin: 0;
            padding: 0;
            background: #000000;
            color: #00ff00;
            font-family: 'JetBrains Mono', 'Share Tech Mono', 'Courier New', monospace;
            overflow-x: hidden;
        }
        
        /* Ensure navigation is visible immediately */
        .nav-tabs {
            background: #000000;
            border-bottom: 2px solid #00ff00;
            padding: 12px;
            display: flex !important;
            flex-wrap: wrap;
            gap: 4px;
            justify-content: center;
            min-height: 60px;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        .nav-tab {
            background: #000000;
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 8px 16px;
            font-family: inherit;
            font-size: 10px;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.15s ease-out;
            text-decoration: none;
            display: inline-block;
            letter-spacing: 1px;
            min-width: 120px;
            text-align: center;
        }
        
        .nav-tab:hover,
        .nav-tab.active {
            background: #00ff00;
            color: #000000;
            box-shadow: 0 0 10px #00ff00;
            transform: translateY(-1px);
        }
        
        /* Hide removed tabs immediately */
        .nav-tab[data-category="technology"],
        .nav-tab[data-category="blockchain"], 
        .nav-tab[data-category="neural_ai"] {
            display: none !important;
        }
        
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 50vh;
            font-size: 18px;
            color: #00ff00;
        }
        
        .news-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            padding: 12px 0;
        }
        
        @media (max-width: 1200px) {
            .news-container {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 900px) {
            .news-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 600px) {
            .news-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <!-- Scanline Effect -->
    <div class="scanline" aria-hidden="true"></div>

    <!-- Header -->
    <header class="header" role="banner">
        <div class="header-content">
            <div class="logo" aria-label="E-con News Terminal Logo">
                üì∞ E-CON_NEWS.EXE
            </div>
            <div class="header-info" role="status" aria-label="Header information">
                <span>v2.024.11</span>
                <span>üåç H·ªí_CH√ç_MINH</span>
                <span id="headerTime">00:00:00</span>
            </div>
        </div>
    </header>

    <!-- Warning Banner -->
    <div class="warning-banner" role="alert">
        ‚ö†Ô∏è H·ªÜ TH·ªêNG C·∫¢NH B√ÅO: REALITY.EXE ƒêANG G·∫∂P L·ªñI NGHI√äM TR·ªåNG - H√ÉY TH·∫¨N TR·ªåNG ‚ö†Ô∏è
    </div>

    <!-- Navigation - FIXED: Removed 3 tabs as requested -->
    <nav class="nav-tabs" role="navigation" aria-label="Danh m·ª•c tin t·ª©c">
        <a href="#" class="nav-tab active" data-category="all" tabindex="0" role="button" aria-pressed="true">
            [T·∫§T_C·∫¢_TIN_T·ª®C]
        </a>
        <a href="#" class="nav-tab" data-category="domestic" tabindex="0" role="button" aria-pressed="false">
            [TIN_N·ªòI_ƒê·ªäA]
        </a>
        <a href="#" class="nav-tab" data-category="international" tabindex="0" role="button" aria-pressed="false">
            [TIN_TO√ÄN_C·∫¶U]
        </a>
        <!-- FIXED: Removed technology, blockchain, neural_ai tabs -->
    </nav>

    <!-- Main Container - FIXED: New layout structure -->
    <main class="main-container" role="main">
        <!-- FIXED: Sidebar with user info, AI panel, news analysis, system load (smaller) -->
        <aside class="sidebar" role="complementary" aria-label="Th√¥ng tin h·ªá th·ªëng">
            <!-- User Info Panel -->
            <section class="user-info" aria-labelledby="user-info-title">
                <h3 id="user-info-title">üë§ TH√îNG TIN NG∆Ø·ªúI D√ôNG</h3>
                <div class="user-stats">
                    <div class="stat-item">
                        <span class="stat-label">ID Phi√™n:</span>
                        <span class="stat-value">#{{ session.get('user_id', 'GUEST') }}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Tr·∫°ng th√°i:</span>
                        <span class="stat-value">TR·ª∞C_TUY·∫æN</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">B√†i ƒë·ªçc:</span>
                        <span class="stat-value">{{ session.get('articles_read', 0) }}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">AI Queries:</span>
                        <span class="stat-value">{{ session.get('ai_queries', 0) }}</span>
                    </div>
                </div>
            </section>

            <!-- AI Panel -->
            <section class="ai-panel" aria-labelledby="ai-panel-title">
                <h3 id="ai-panel-title">ü§ñ C√ÇU H·ªéI AI</h3>
                <div class="ai-stats">
                    <div class="stat-item">
                        <span class="stat-label">Engine:</span>
                        <span class="stat-value">GEMINI_2.0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Tr·∫°ng th√°i:</span>
                        <span class="stat-value">S·∫¥N_S√ÄNG</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">T√≥m t·∫Øt:</span>
                        <span class="stat-value">100-200 t·ª´</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Tranh lu·∫≠n:</span>
                        <span class="stat-value">6 NH√ÇN V·∫¨T</span>
                    </div>
                </div>
            </section>

            <!-- News Analysis Panel -->
            <section class="news-analysis" aria-labelledby="analysis-title">
                <h3 id="analysis-title">üìä TIN T·ª®C PH√ÇN T√çCH</h3>
                <div class="analysis-stats">
                    <div class="stat-item">
                        <span class="stat-label">Ngu·ªìn:</span>
                        <span class="stat-value">15+ FEEDS</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">C·∫≠p nh·∫≠t:</span>
                        <span class="stat-value">REAL-TIME</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Tin m·ªõi:</span>
                        <span class="stat-value" id="newsCount">ƒêang t·∫£i...</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">L·∫ßn cu·ªëi:</span>
                        <span class="stat-value" id="lastUpdate">--:--:--</span>
                    </div>
                </div>
            </section>

            <!-- System Load Panel -->
            <section class="system-load" aria-labelledby="system-title">
                <h3 id="system-title">‚ö° T·∫¢I H·ªÜ TH·ªêNG</h3>
                <div class="load-stats">
                    <div class="stat-item">
                        <span class="stat-label">CPU:</span>
                        <span class="stat-value">69%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">RAM:</span>
                        <span class="stat-value">420MB</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Users:</span>
                        <span class="stat-value">1.337M</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Uptime:</span>
                        <span class="stat-value">99.9%</span>
                    </div>
                </div>
            </section>
        </aside>

        <!-- FIXED: Content Area (larger news panel) -->
        <section class="content-area" role="region" aria-labelledby="content-title">
            <div class="content-header">
                <h2 class="content-title" id="content-title">üì° LU·ªíNG TIN T·ª®C TR·ª∞C TI·∫æP</h2>
                <div class="content-controls">
                    <button class="control-btn" onclick="window.econ?.loadNews(window.econ?.currentPage)" aria-label="L√†m m·ªõi tin t·ª©c">
                        üîÑ L√ÄM M·ªöI
                    </button>
                    <button class="control-btn" onclick="window.econ?.openChatWindow()" aria-label="M·ªü chat AI">
                        ü§ñ AI CHAT
                    </button>
                </div>
            </div>

            <!-- FIXED: News Container with 4-column grid -->
            <div class="news-container" id="newsContainer" role="feed" aria-label="Tin t·ª©c m·ªõi nh·∫•t" aria-live="polite">
                <div class="loading">
                    üîÑ ƒêANG T·∫¢I TIN T·ª®C...
                </div>
            </div>
        </section>
    </main>

    <!-- Chat Bubble -->
    <div class="chat-bubble" id="chatBubble" onclick="window.econ?.openChatWindow()" role="button" tabindex="0" aria-label="M·ªü chat AI" title="Nh·∫•n ƒë·ªÉ chat v·ªõi AI">
        ü§ñ
    </div>

    <!-- Chat Window -->
    <div class="chat-window" id="chatWindow" role="dialog" aria-labelledby="chat-title" aria-modal="false">
        <div class="chat-window-header">
            <span class="chat-window-title" id="chat-title">ü§ñ AI TERMINAL</span>
            <div class="chat-controls">
                <button class="chat-btn" onclick="window.econ?.closeChatWindow()" aria-label="ƒê√≥ng chat" title="ƒê√≥ng">√ó</button>
            </div>
        </div>
        
        <div class="chat-messages" id="chatMessages" role="log" aria-label="Tin nh·∫Øn chat" aria-live="polite">
            <div class="chat-message ai">
                ü§ñ Ch√†o b·∫°n! T√¥i l√† AI tr·ª£ l√Ω c·ªßa E-con News Terminal. H√£y m·ªü m·ªôt b√†i vi·∫øt v√† s·ª≠ d·ª•ng c√°c n√∫t b√™n d∆∞·ªõi ƒë·ªÉ t√≥m t·∫Øt ho·∫∑c tranh lu·∫≠n ƒëa quan ƒëi·ªÉm.
            </div>
        </div>
        
        <div class="chat-input-area">
            <div class="quick-actions">
                <button class="quick-btn summary" aria-label="T√≥m t·∫Øt b√†i vi·∫øt">üìã T√ìM T·∫ÆT</button>
                <button class="quick-btn debate" aria-label="Tranh lu·∫≠n ƒëa quan ƒëi·ªÉm">üé≠ TRANH LU·∫¨N</button>
            </div>
            <div class="chat-input-row">
                <textarea class="chat-input" id="chatInput" placeholder="Nh·∫≠p c√¢u h·ªèi c·ªßa b·∫°n..." aria-label="Nh·∫≠p c√¢u h·ªèi cho AI" rows="1"></textarea>
                <button class="chat-send-btn" id="sendBtn" aria-label="G·ª≠i tin nh·∫Øn">‚ñ∂</button>
            </div>
        </div>
    </div>

    <!-- Article Detail Modal -->
    <div class="modal" id="articleModal" role="dialog" aria-labelledby="modal-title" aria-modal="true" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-title"></h2>
                <button class="close-modal" onclick="window.econ?.closeArticleModal()" aria-label="ƒê√≥ng b√†i vi·∫øt">√ó</button>
            </div>
            <div class="modal-meta">
                <span id="articleSource"></span>
                <a href="#" id="articleLink" target="_blank" rel="noopener noreferrer">Xem g·ªëc</a>
            </div>
            <div class="modal-body" id="articleContent">
                ƒêang t·∫£i n·ªôi dung...
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer" role="contentinfo">
        <div class="hotkeys" role="group" aria-label="Ph√≠m t·∫Øt">
            <span class="hotkey" tabindex="0" title="Tr·ª£ gi√∫p">[F1] HELP</span>
            <span class="hotkey" tabindex="0" title="Ch·∫ø ƒë·ªô matrix">[F4] MATRIX</span>
            <span class="hotkey" tabindex="0" title="L√†m m·ªõi d·ªØ li·ªáu">[F5] L√ÄM_M·ªöI</span>
        </div>
        <div class="system-info" role="status" aria-label="Th√¥ng tin h·ªá th·ªëng">
            <span class="status-online">NG∆Ø·ªúI_D√ôNG: 1.337.420</span>
            <span aria-hidden="true">|</span>
            <span class="cpu-usage">CPU: 69%</span>
            <span aria-hidden="true">|</span>
            <span class="ram-usage">RAM: 420MB</span>
            <span aria-hidden="true">|</span>
            <time id="currentTime">00:00:00</time>
        </div>
    </footer>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer" role="region" aria-live="polite" aria-label="Th√¥ng b√°o">
        <!-- Toast notifications will appear here -->
    </div>

    <!-- Screen Reader Only Content -->
    <div class="sr-only">
        <h1>E-con News Terminal - C·ªïng tin t·ª©c t√†i ch√≠nh ƒë∆∞·ª£c h·ªó tr·ª£ b·ªüi AI</h1>
        <p>ƒêi·ªÅu h∆∞·ªõng b·∫±ng ph√≠m Tab. Nh·∫•n F1 ƒë·ªÉ ƒë∆∞·ª£c tr·ª£ gi√∫p, F4 cho hi·ªáu ·ª©ng ƒë·∫∑c bi·ªát, F5 ƒë·ªÉ l√†m m·ªõi.</p>
    </div>

    <!-- Scripts -->
    <script src="{{ url_for('static', filename='script.js') }}?v={{ range(1000, 9999) | random }}" defer></script>
    
    <!-- Update time display -->
    <script>
        function updateHeaderTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('vi-VN', { 
                hour12: false,
                timeZone: 'Asia/Ho_Chi_Minh'
            });
            
            const headerTime = document.getElementById('headerTime');
            if (headerTime) {
                headerTime.textContent = timeString;
            }
        }
        
        // Update immediately and then every second
        updateHeaderTime();
        setInterval(updateHeaderTime, 1000);
    </script>

    <!-- Accessibility Enhancements -->
    <style>
        /* High contrast mode support */
        @media (prefers-contrast: high) {
            :root {
                --terminal-green: #00ff00;
                --terminal-red: #ff0000;
                --terminal-cyan: #00ffff;
                --bg-black: #000000;
                --terminal-white: #ffffff;
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .scanline {
                display: none;
            }
        }

        /* Focus indicators */
        *:focus-visible {
            outline: 2px solid var(--terminal-cyan);
            outline-offset: 2px;
        }

        /* Skip link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--terminal-green);
            color: var(--bg-black);
            padding: 8px;
            text-decoration: none;
            z-index: 9999;
            font-family: var(--font-mono);
            font-weight: bold;
        }

        .skip-link:focus {
            top: 6px;
        }
    </style>
</body>
</html>
